<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>KT9</title>
</head>
<body>
    <h1>Пример веб-компонента: <code>&lt;user-list&gt;</code></h1>
            <p>Отображает список постов из публичного API.</p>
            <user-list limit="5"></user-list>
  <script>
    class UserList extends HTMLElement {
      constructor() {
        super();
        this.attachShadow({ mode: 'open' });
        this.container = document.createElement('div');
        this.shadowRoot.appendChild(this.container);
        const style = document.createElement('style');
        style.textContent = `
        .posts-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

          .post {
            background-color: #fff;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
          }
          .title {
            font-weight: bold;
            color: #333;
          }
          .body {
            color: #555;
            margin-top: 5px;
          }
          .error {
            color: red;
            font-weight: bold;
          }
          .loading {
            color: gray;
          }
        `;
        this.shadowRoot.appendChild(style);
      }
      connectedCallback() {
        this.loadData();
      }

      async loadData() {
        const limit = this.getAttribute('limit') || 5;
        this.container.innerHTML = `<p class="loading">Загрузка...</p>`;

        try {
          const response = await fetch('https://jsonplaceholder.typicode.com/posts');
          
          if (!response.ok) {
            throw new Error('Ошибка загрузки');
          }

          const data = await response.json();
          const limitedData = data.slice(0, limit);

          this.renderPosts(limitedData);

        } catch (error) {
          this.container.innerHTML = `<p class="error">Ошибка загрузки</p>`;
        }
      }
        renderPosts(posts) {
        this.container.innerHTML = `
        <div class="posts-container">
        ${posts.map(post => `
        <div class="post">
            <div class="title">${post.title}</div>
            <div class="body">${post.body}</div>
            <div><small>ID поста: ${post.id}</small></div>
        </div>`).join('')}
        </div>
        `;
        }}
    customElements.define('user-list', UserList);
  </script>
</body>
</html>
